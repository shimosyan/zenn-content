---
title: "Microsoft Intune ç”¨ã« Web ã‹ã‚‰ MSI ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ï¼†å±•é–‹ã§ãã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œã£ãŸ"
emoji: "ğŸ“˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Intune", "PowerShell", "Windows"]
published: true
---

## ã“ã‚Œã¯ä½•ï¼Ÿ

Intune ã§ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å±•é–‹ã«ãŠã„ã¦ã€MSI ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©å½¢å¼ã§é…å¸ƒã•ã‚Œã¦ã„ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç®¡ç†ãƒ‡ãƒã‚¤ã‚¹ã«å±•é–‹ã§ãã¾ã™ã€‚

ä»Šå›ã€é‹ç”¨ã®ã‚„ã‚Šã‚„ã™ã•ã‚’ä¸Šã’ã‚‹ãŸã‚ã«å®Ÿæ–½ã—ãŸå–ã‚Šçµ„ã¿ã‚’ã“ã“ã«ã¾ã¨ã‚ã¾ã™ã€‚

## æƒ³å®šã™ã‚‹èª­è€…

ä»¥ä¸‹ã‚’æº€ãŸã™äººã‚’å¯¾è±¡ã¨ã—ã¦ã„ã¾ã™ã€‚

- Intune ã§ã€ŒWindows ã‚¢ãƒ—ãƒªï¼ˆWin32ï¼‰ã€ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç™»éŒ²ãŒã§ãã‚‹äºº
- Intune ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é…å¸ƒã®æ‰‹é–“ã‚’æ¸›ã‚‰ã—ãŸã„äºº

## èª²é¡Œ1ï¼šã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä¸ŠãŒã‚‹ãŸã³ã«é…å¸ƒãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ Intune ã«ç™»éŒ²ã™ã‚‹å¿…è¦ãŒã‚ã‚‹

ã“ã‚Œã¯ Intune ã«é™ã‚‰ãš MDM é–¢é€£ã§ã¯ã‚ã‚‹ã‚ã‚‹ãªè©±ã§ã™ãŒã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®é…å¸ƒã«ãŠã„ã¦ MDM ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ã‚’ç›´æ¥ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨ãƒ‡ãƒã‚¤ã‚¹ã«é…å¸ƒã•ã‚Œã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå›ºå®šåŒ–ã•ã‚Œã¦ã—ã¾ã†èª²é¡ŒãŒã‚ã‚Šã¾ã™ã€‚

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦ã¯è‡ªå‹•ã§ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã•ã‚Œã‚‹ã«ã—ã¦ã‚‚ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ããªã£ãŸã‚‚ã®ã‚’é…å¸ƒã™ã‚‹ã“ã¨ã¯ã‚ãšã‹ãªãŒã‚‰ã‚‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãƒªã‚¹ã‚¯ã‚’ä¼´ã„ã¾ã™ã€‚

ã“ã‚Œã‚’è§£æ±ºã™ã‚‹ã«ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä¸ŠãŒã£ãŸéš›ã«ã¯éƒ½åº¦ MDM ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãŒã€Intune ã«ãŠã„ã¦ã¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`.intunewin`ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‹ï¼‰ã‚’ç”¨æ„ã™ã‚‹ã®ã¯æ‰‹é–“ã§ã™ã‚ˆã­â€¦â€¦ã€‚

## èª²é¡Œ2ï¼šã€ŒWindows ã‚¢ãƒ—ãƒªï¼ˆWin32ï¼‰ã€ã¨ã€ŒåŸºå¹¹æ¥­å‹™ã‚¢ãƒ—ãƒªã€ãŒåŒæ™‚åˆ©ç”¨ã§ããªã„

ã“ã‚Œå€‹äººçš„ã«ã¯ Intune ã®ç½ ãƒã‚¤ãƒ³ãƒˆã¨æ€ã£ã¦ã„ã‚‹ã®ã§ã™ãŒã€Intune ã§ã¯ã€ŒWindows ã‚¢ãƒ—ãƒªï¼ˆWin32ï¼‰ã€å½¢å¼ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é…å¸ƒã™ã‚‹å ´åˆã€åŒã˜ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«åˆ¥å½¢å¼ï¼ˆåŸºå¹¹æ¥­å‹™ã‚¢ãƒ—ãƒªãªã©ï¼‰ã‚’ä½¿ã£ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é…å¸ƒã™ã‚‹ã“ã¨ã¯éæ¨å¥¨ã¨ã•ã‚Œã¦ã„ã¾ã™ã€‚

@[card](https://learn.microsoft.com/ja-jp/mem/intune/apps/apps-win32-troubleshoot)

> Win32 ã‚¢ãƒ—ãƒªã‚’å±•é–‹ã™ã‚‹å ´åˆã€ç‰¹ã«è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã® Win32 ã‚¢ãƒ—ãƒª ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ãŒã‚ã‚‹å ´åˆã¯ã€Intune ç®¡ç†æ‹¡å¼µæ©Ÿèƒ½ã®æ–¹æ³•ã‚’æ’ä»–çš„ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚ Autopilot ç™»éŒ²ä¸­ã« Win32 ã‚¢ãƒ—ãƒªã¨åŸºå¹¹æ¥­å‹™ (LOB) ã‚¢ãƒ—ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’æ··åœ¨ã•ã›ã‚‹å ´åˆã€ã‚¢ãƒ—ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¤±æ•—ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ãŠãã‚‰ãã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®æ’ä»–å‡¦ç†ãŒæ­£ã—ãå‡¦ç†ã•ã‚Œã¦ã„ãªã„ã®ã§ã¯ã¨æ€ã£ã¦ã„ã‚‹ã®ã§ã™ãŒã€AutoPilot ãªã©ãƒ‡ãƒã‚¤ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã«ã¦å¤šé‡ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‡¦ç†ã‚’ã•ã›ãŸã„ã‚±ãƒ¼ã‚¹ã§æ’ä»–å‡¦ç†ãŒæœŸå¾…é€šã‚Šã«å‹•ã‹ãªã„ã®ã¯ã¡ã‚‡ã£ã¨è‹¦ã—ã„ã§ã™ã­ã€‚

ã¤ã¾ã‚‹ã¨ã“ã‚ã€æœ¬å•é¡Œã‚’å›é¿ã™ã‚‹ã«ã¯ MSI å½¢å¼ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ã§ã‚‚ã€ŒWindows ã‚¢ãƒ—ãƒªï¼ˆWin32ï¼‰ã€ã§ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚ã‘ã§ã™ã€‚çµå±€ã€ã€ŒåŸºå¹¹æ¥­å‹™ã‚¢ãƒ—ãƒªã€ã ã£ãŸã‚‰ MSI ã‚’ã‚µã‚¯ãƒƒã¨å·®ã—æ›¿ãˆãŒã§ãã‚‹ã¨ã“ã‚ãŒã€èª²é¡Œ 1 ã§æŒ™ã’ãŸã‚ˆã†ã«é‹ç”¨ãŒé‡ãŸã„ã€ŒWindows ã‚¢ãƒ—ãƒªï¼ˆWin32ï¼‰ã€ã«ãªã£ã¦ã—ã¾ã†ã‚ã‘ã§ã™â€¦ã€‚

## æœ¬ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã§ãã‚‹ã“ã¨

ã“ã®è¨˜äº‹ã§ç´¹ä»‹ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’æœ‰ã—ã¾ã™ã€‚

- æŒ‡å®šã—ãŸ URL ã‹ã‚‰ MSI ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ã‚’è‡ªå‹•å–å¾—ï¼†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

## äº‹å‰æº–å‚™ã§å¿…è¦ãªæƒ…å ±

æœ¬ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ã†å ´åˆã¯ä»¥ä¸‹ã®æƒ…å ±ãŒäºˆã‚å¿…è¦ã§ã™ã€‚

### MSI ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã®å…¬é–‹ URL

å°å…¥ã—ãŸã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã® MSI ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã®é…å¸ƒå…ˆã§ã™ã€‚
æœ¬ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã“ã® URL ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

ã“ã® URL ã¯æ°—åˆã„ã§æ¢ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€ç§ãŒèª¿æŸ»ã—ãŸã‚‚ã®ã‚’ã„ãã¤ã‹ç´¹ä»‹ã—ã¾ã™ã€‚

|ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³|é…å¸ƒ URL|
|---|---|
|Google Chrome (64bit)|`https://dl.google.com/tag/s/appguid%3D%7B8A69D345-D564-463C-AFF1-A69D9E530F96%7D%26iid%3D%7B68387BA0-557D-F80F-58A1-9E5EDDE82361%7D%26browser%3D5%26usagestats%3D0%26appname%3DGoogle%2520Chrome%26needsadmin%3Dtrue%26ap%3Dx64-stable-statsdef_0%26brand%3DGCPK/dl/chrome/install/googlechromestandaloneenterprise64.msi`|
|Zoom (64bit)|`https://zoom.us/client/latest/ZoomInstallerFull.msi?archType=x64`|
|1Password|`https://downloads.1password.com/win/1PasswordSetup-latest.msi`|

:::message
Google Chrome ã«ã¤ã„ã¦ã€URL ã«å«ã¾ã‚Œã¦ã„ã‚‹ã‚¿ã‚°ã®æœ‰ç„¡ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æŒ™å‹•ãŒç•°ãªã‚Šã¾ã™ã€‚ãã®ãŸã‚ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®ã¾ã¾ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
:::

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åç§°

æœ¬ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨ãã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç‰¹å®šã®ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚

MSI å½¢å¼ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸå ´åˆ `Product ID` ã¨å‘¼ã°ã‚Œã‚‹è­˜åˆ¥å­ãŒ Windows ã«ç™»éŒ²ã•ã‚Œã€ãã®è­˜åˆ¥å­ã‚’ç”¨ã„ã¦ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ã§ãã¾ã™ã€‚ã—ã‹ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹ã”ã¨ã« `Product ID` ãŒå¤‰åŒ–ã™ã‚‹ã‚‰ã—ã„ï¼ˆæƒ…å ±æ±‚ã‚€ï¼‰ã®ã§ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åã‚’ç”¨ã„ã¦ `Product ID` ã‚’ç‰¹å®šã—ã¾ã™ã€‚

Windows ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åã‚’ãã®ã¾ã¾ä½¿ã„ã¾ã™ã€‚å³å¯†ã«åç§°ã‚’èª¿ã¹ãŸã„ã¨ãã¯ä»¥ä¸‹ã®ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚­ãƒ¼ã‚’é–‹ã„ã¦ `DisplayName` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å€¤ã‚’èª¿ã¹ã¾ã™ã€‚

```txt
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}
```

ã“ã“ã§ã‚‚ç§ãŒèª¿æŸ»ã—ãŸã‚‚ã®ã‚’ã„ãã¤ã‹ç´¹ä»‹ã—ã¾ã™ã€‚

|ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³|ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åç§°|
|---|---|
|Google Chrome (64bit)|`Google Chrome`|
|Zoom (64bit)|`Zoom Workplace (64-bit)`|
|1Password|`1Password`|

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æœ¬ä½“ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹

å¾Œè¿°ã®ã€Œæ¤œå‡ºãƒ«ãƒ¼ãƒ«ã€ãªã©ã§ä½¿ã†ãŸã‚ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æœ¬ä½“ãŒä¿å­˜ã•ã‚Œã‚‹ãƒ‘ã‚¹ã‚’èª¿ã¹ã¦ãŠãã¾ã™ã€‚

## ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä½œæˆ

ä¸‹è¨˜ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã¦ `.intunewin` å½¢å¼ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°ã—ã¦ãã ã•ã„ã€‚ãƒ•ã‚¡ã‚¤ãƒ«åã€ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã¯ä»¥ä¸‹ã§ä½œæˆã—ã¦ãã ã•ã„ã€‚

- ãƒ•ã‚¡ã‚¤ãƒ«åï¼š`msiInstaller.ps1`
- æ–‡å­—ã‚³ãƒ¼ãƒ‰ï¼šã‚¹ã‚¯ãƒªãƒ—ãƒˆã«æ—¥æœ¬èªãŒå«ã¾ã‚Œã¦ã„ã‚‹ãŸã‚ `UTF-8 with BOM`
- æ”¹è¡Œã‚³ãƒ¼ãƒ‰ï¼š`CRLF`

```powershell
param(
    [string]$label = "",
    [string]$installerUrl = "",
    [string]$appendArguments = "",
    [switch]$uninstall = $false,
    [switch]$isDebug = $false
)

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¤œè¨¼ã‚’é–¢æ•°å†…ã§å®Ÿè¡Œ
function Validate-Parameters {
    if ([string]::IsNullOrWhiteSpace($label)) {
        Write-Error "ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åï¼ˆ-labelï¼‰ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚"
        exit 1
    }

    if (-not $uninstall -and [string]::IsNullOrWhiteSpace($installerUrl)) {
        Write-Error "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ¢ãƒ¼ãƒ‰ã§ã¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰URLï¼ˆ-installerUrlï¼‰ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚"
        exit 1
    }
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†ã®é–‹å§‹æ™‚ã«æ¤œè¨¼
Validate-Parameters

$ProgressPreference = "SilentlyContinue"

# ãƒ­ã‚°å‡ºåŠ›é–¢æ•°
function Write-Log {
    param([string]$Message)

    if ($isDebug) {
        # ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã®å ´åˆã®ã¿ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›
        if (-not $script:logInitialized) {
            $script:logPath = "C:\IntuneLog"
            if (!(Test-Path $script:logPath)) {
                New-Item -ItemType Directory -Path $script:logPath -Force | Out-Null
            }
            $script:logFile = Join-Path $script:logPath "msiInstaller_$(Get-Date -Format 'yyyyMMdd_HHmmss').log"
            $script:logInitialized = $true
        }
        $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
        "$timestamp - $Message" | Out-File -FilePath $script:logFile -Append
    }

    # ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã¯å¸¸ã«è¡Œã†
    Write-Host $Message
}

# å‡¦ç†æƒ…å ±ã‚’å‡ºåŠ›
Write-Log "====== INFO ======"
Write-Log "PowerShell Version: $($PSVersionTable.PSVersion)"
Write-Log "Execution Policy: $(Get-ExecutionPolicy)"
Write-Log "Script Path: $($MyInvocation.MyCommand.Path)"
Write-Log "Current User: $env:USERNAME"
Write-Log "Current Directory: $(Get-Location)"
Write-Log "Process Architecture: $([Environment]::Is64BitProcess)"
Write-Log "OS Architecture: $([Environment]::Is64BitOperatingSystem)"
Write-Log "Parameters received:"
Write-Log "  label: '$label'"
Write-Log "  installerUrl: '$installerUrl'"
Write-Log "  appendArguments: '$appendArguments'"
Write-Log "  uninstall: $uninstall"
Write-Log "  isDebug: $isDebug"
Write-Log "=================="

# ãƒ¬ã‚¸ã‚¹ãƒˆãƒªæ¤œç´¢é–¢æ•°ï¼ˆreg.exe + .NETãƒ¡ã‚½ãƒƒãƒ‰ä½¿ç”¨ï¼‰
function Search-RegistryForProduct {
    param([string]$ProductName)

    $productIds = @()

    Write-Log "ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚’æ¤œç´¢ä¸­..."

    # 64bitã‚·ã‚¹ãƒ†ãƒ ã‹ãƒã‚§ãƒƒã‚¯
    if ([Environment]::Is64BitOperatingSystem) {
        # 32bitãƒ—ãƒ­ã‚»ã‚¹ã‹ã‚‰å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆã®å‡¦ç†
        if (-not [Environment]::Is64BitProcess) {
            Write-Log "32bitãƒ—ãƒ­ã‚»ã‚¹ã‹ã‚‰å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã™ã€‚WOW64ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’å›é¿ã—ã¾ã™ã€‚"

            # æ–¹æ³•1: reg.exeã‚’ä½¿ç”¨ï¼ˆ64bitç‰ˆãŒè‡ªå‹•çš„ã«ä½¿ã‚ã‚Œã‚‹ï¼‰
            Write-Log "reg.exeã‚’ä½¿ç”¨ã—ã¦64bitãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚’æ¤œç´¢ä¸­..."
            $regOutput = & reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" /s 2>&1
            $currentKey = ""
            foreach ($line in $regOutput) {
                if ($line -match "^HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\(.+)$") {
                    $currentKey = $matches[1]
                } elseif ($line -match "^\s+DisplayName\s+REG_SZ\s+(.+)$") {
                    $displayName = $matches[1].Trim()
                    if ($displayName -eq $ProductName) {
                        Write-Log "  64bit: è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ - $displayName (ID: $currentKey)"
                        $productIds += [PSCustomObject]@{
                            ProductId = $currentKey
                            DisplayName = $displayName
                            Architecture = "64bit"
                        }
                    }
                }
            }

            # æ–¹æ³•2: PowerShellã®.NETãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨
            Write-Log ".NETãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦64bitãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚’æ¤œç´¢ä¸­..."
            try {
                $key64 = [Microsoft.Win32.RegistryKey]::OpenBaseKey([Microsoft.Win32.RegistryHive]::LocalMachine, [Microsoft.Win32.RegistryView]::Registry64)
                $uninstallKey64 = $key64.OpenSubKey("SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall")

                foreach ($subKeyName in $uninstallKey64.GetSubKeyNames()) {
                    $subKey = $uninstallKey64.OpenSubKey($subKeyName)
                    $displayName = $subKey.GetValue("DisplayName")
                    if ($displayName -and $displayName -eq $ProductName) {
                        Write-Log "  64bit (.NET): è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ - $displayName (ID: $subKeyName)"
                        if (-not ($productIds | Where-Object { $_.ProductId -eq $subKeyName })) {
                            $productIds += [PSCustomObject]@{
                                ProductId = $subKeyName
                                DisplayName = $displayName
                                Architecture = "64bit"
                            }
                        }
                    }
                    $subKey.Close()
                }
                $uninstallKey64.Close()
                $key64.Close()
            } catch {
                Write-Log "ERROR: .NETãƒ¡ã‚½ãƒƒãƒ‰ã§ã®64bitãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚¢ã‚¯ã‚»ã‚¹ã«å¤±æ•—: $_"
            }
        } else {
            # 64bitãƒ—ãƒ­ã‚»ã‚¹ã‹ã‚‰å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆ
            Write-Log "64bitãƒ—ãƒ­ã‚»ã‚¹ã‹ã‚‰å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã™ã€‚é€šå¸¸ã®PowerShellãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚¢ã‚¯ã‚»ã‚¹ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚"
            $reg64Items = Get-ChildItem -Path "Registry::HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" -ErrorAction SilentlyContinue
            foreach ($item in $reg64Items) {
                $prop = Get-ItemProperty -Path $item.PSPath -ErrorAction SilentlyContinue
                if ($prop.DisplayName -and $prop.DisplayName -eq $ProductName) {
                    Write-Log "  64bit: è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ - $($prop.DisplayName) (ID: $($item.PSChildName))"
                    $productIds += [PSCustomObject]@{
                        ProductId = $item.PSChildName
                        DisplayName = $prop.DisplayName
                        Architecture = "64bit"
                    }
                }
            }
        }

        # 32bitãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚‚æ¤œç´¢ï¼ˆWOW6432Nodeï¼‰
        Write-Log "32bitãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚’æ¤œç´¢ä¸­..."
        $reg32Items = Get-ChildItem -Path "Registry::HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall" -ErrorAction SilentlyContinue
        foreach ($item in $reg32Items) {
            $prop = Get-ItemProperty -Path $item.PSPath -ErrorAction SilentlyContinue
            if ($prop.DisplayName -and $prop.DisplayName -eq $ProductName) {
                Write-Log "  32bit: è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ - $($prop.DisplayName) (ID: $($item.PSChildName))"
                $productIds += [PSCustomObject]@{
                    ProductId = $item.PSChildName
                    DisplayName = $prop.DisplayName
                    Architecture = "32bit"
                }
            }
        }
    } else {
        # 32bitã‚·ã‚¹ãƒ†ãƒ ã®å ´åˆ
        Write-Log "32bitã‚·ã‚¹ãƒ†ãƒ ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã™"
        $regItems = Get-ChildItem -Path "Registry::HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" -ErrorAction SilentlyContinue
        foreach ($item in $regItems) {
            $prop = Get-ItemProperty -Path $item.PSPath -ErrorAction SilentlyContinue
            if ($prop.DisplayName -and $prop.DisplayName -eq $ProductName) {
                Write-Log "  è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ - $($prop.DisplayName) (ID: $($item.PSChildName))"
                $productIds += [PSCustomObject]@{
                    ProductId = $item.PSChildName
                    DisplayName = $prop.DisplayName
                    Architecture = "32bit"
                }
            }
        }
    }

    return $productIds
}

try {
    #
    # ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‡¦ç†ã“ã“ã‹ã‚‰
    #
    if ($uninstall)
    {
        Write-Log "ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‡¦ç†ã‚’é–‹å§‹ã—ã¾ã™"
        Write-Log "æ¤œç´¢å¯¾è±¡ã®DisplayName: '$label'"

        # ãƒ¬ã‚¸ã‚¹ãƒˆãƒªæ¤œç´¢
        $productIds = @(Search-RegistryForProduct -ProductName $label)

        Write-Log "æ¤œç´¢çµæœ: $($productIds.Count)å€‹ã®è£½å“ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ"

        if ($productIds.Count -eq 0) {
            Write-Error "ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚"
            exit 1
        }

        # è¤‡æ•°è¦‹ã¤ã‹ã£ãŸå ´åˆã®å‡¦ç†
        if ($productIds.Count -gt 1) {
            Write-Log "è¤‡æ•°ã®è£½å“ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ:"
            $productIds | ForEach-Object {
                Write-Log "  - $($_.DisplayName) [ID: $($_.ProductId), Arch: $($_.Architecture)]"
            }
            # 64bitç‰ˆã‚’å„ªå…ˆ
            $selected = $productIds | Where-Object { $_.Architecture -eq "64bit" } | Select-Object -First 1
            if (-not $selected) {
                $selected = $productIds[0]
            }
            Write-Log "é¸æŠ: $($selected.Architecture)ç‰ˆã‚’ä½¿ç”¨ã—ã¾ã™"
        } else {
            $selected = $productIds[0]
        }

        Write-Log "ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯¾è±¡: $($selected.DisplayName) [ID: $($selected.ProductId)]"

        # å–å¾—ã—ãŸè£½å“ID(Product ID)ã‚’ä½¿ã£ã¦ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Ÿè¡Œ
        $process = Start-Process -NoNewWindow -PassThru -Wait -FilePath "msiexec" -ArgumentList "/x", $selected.ProductId, "/qn"

        Write-Log "ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«çµ‚äº†ã‚³ãƒ¼ãƒ‰: $($process.ExitCode)"

        # æ­£å¸¸çµ‚äº†ã¾ãŸã¯æ—¢ã«ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã®å ´åˆã¯æˆåŠŸã¨ã™ã‚‹
        if ($process.ExitCode -eq 0 -or $process.ExitCode -eq 1605) {
            Write-Log "ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸ"
            exit 0
        } else {
            Write-Error "ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«å¤±æ•—ã—ã¾ã—ãŸã€‚çµ‚äº†ã‚³ãƒ¼ãƒ‰: $($process.ExitCode)"
            exit $process.ExitCode
        }
    }
    #
    # ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‡¦ç†ã“ã“ã¾ã§
    #

    #
    # ä»¥ä¸‹ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‡¦ç†
    #
    Write-Log "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‡¦ç†ã‚’é–‹å§‹ã—ã¾ã™"

    $installerLabel = $label.replace(" ","")
    $installerName = "$installerLabel.msi"

    Write-Log "ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å…ˆ: $installerName"
    Write-Log "ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å…ƒ: $installerUrl"

    # ãƒ—ãƒ­ã‚­ã‚·è¨­å®šã‚’å–å¾—ï¼ˆã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ã‚­ã‚·ã‚’ä½¿ç”¨ï¼‰
    $proxy = [System.Net.WebRequest]::GetSystemWebProxy()
    $proxyUri = $proxy.GetProxy($installerUrl)

    if ($proxyUri -ne $installerUrl) {
        Write-Log "ãƒ—ãƒ­ã‚­ã‚·ã‚’ä½¿ç”¨ã—ã¾ã™: $proxyUri"
        Invoke-WebRequest -UseBasicParsing -Uri $installerUrl -OutFile $installerName -Proxy $proxyUri -ProxyUseDefaultCredentials
    } else {
        Write-Log "ç›´æ¥æ¥ç¶šã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™"
        Invoke-WebRequest -UseBasicParsing -Uri $installerUrl -OutFile $installerName
    }

    if (!(Test-Path $installerName)) {
        Write-Error "MSIãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ"
        exit 1
    }

    Write-Log "MSIãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¾ã—ãŸ"

    # MSI ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ã‚µã‚¤ãƒ¬ãƒ³ãƒˆãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œ
    $arguments = @("/i", $installerName)

    # è¿½åŠ å¼•æ•°ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯è¿½åŠ 
    if ($appendArguments -and $appendArguments.Trim() -ne "") {
        $additionalArgs = $appendArguments -split '\s+' | Where-Object { $_ }
        if ($additionalArgs -and $additionalArgs.Count -gt 0) {
            $arguments += $additionalArgs
            Write-Log "è¿½åŠ å¼•æ•°: $($additionalArgs -join ' ')"
        }
    }
    # æœ€å¾Œã« /qn ã‚’è¿½åŠ 
    $arguments += "/qn"

    Write-Log "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’å®Ÿè¡Œã—ã¾ã™: msiexec $($arguments -join ' ')"
    $process = Start-Process -NoNewWindow -PassThru -Wait -FilePath "msiexec" -ArgumentList $arguments

    Write-Log "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«çµ‚äº†ã‚³ãƒ¼ãƒ‰: $($process.ExitCode)"

    # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤
    if (Test-Path $installerName) {
        Remove-Item $installerName -Force
        Write-Log "ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¾ã—ãŸ"
    }

    # çµ‚äº†ã‚³ãƒ¼ãƒ‰ã‚’ãƒã‚§ãƒƒã‚¯
    if ($process.ExitCode -eq 0) {
        Write-Log "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸ"
        exit 0
    } elseif ($process.ExitCode -eq 3010) {
        Write-Log "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ã¾ã—ãŸï¼ˆå†èµ·å‹•ãŒå¿…è¦ï¼‰"
        exit 3010
    } else {
        Write-Error "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«å¤±æ•—ã—ã¾ã—ãŸã€‚çµ‚äº†ã‚³ãƒ¼ãƒ‰: $($process.ExitCode)"
        exit $process.ExitCode
    }

} catch {
    Write-Log "ERROR: äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: $_"
    Write-Log "ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹: $($_.ScriptStackTrace)"
    Write-Error "äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: $_"
    exit 1
} finally {
    Write-Log "=== SCRIPT END ==="
}

```

## Intune ã®é…å¸ƒè¨­å®š

ä¸Šè¨˜ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ ¼ç´ã—ãŸ `.intunewin` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ Intune ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚

é…å¸ƒè¨­å®šã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚

### ãƒ—ãƒ­ã‚°ãƒ©ãƒ 

![ãƒ—ãƒ­ã‚°ãƒ©ãƒ ç”»é¢ã®å…¥åŠ›ä¾‹](/images/intune_msi_installer/intune_program.png)

:::message
ç”»åƒã§ã¯ `Path` ã‚’è¦æ±‚ã—ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã¾ã™ãŒã€å®Ÿã¯ã“ã®ç”»åƒã¯ã¡ã‚‡ã£ã¨å¤ãã¦ä»Šã¯ä¸è¦ã«ã§ããŸã®ã§ç„¡è¦–ã—ã¦ãã ã•ã„ã€‚
:::

#### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚³ãƒãƒ³ãƒ‰

ä¸‹è¨˜æ–‡å­—åˆ—ã‚’å…¥åŠ›ã—ã¾ã™ã€‚ä¸€éƒ¨æ›¸ãæ›ãˆãªã„ã¨ã„ã‘ãªã„ç®‡æ‰€ãŒã‚ã‚‹ã®ã§ä¸‹è¡¨ã‹ã‚‰ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚

```sh
powershell -ExecutionPolicy Bypass -File ".\msiInstaller.ps1" -label "$LABEL" -installerUrl "$URL" -appendArguments "$APPEND_ARGUMENTS"
```

|ã‚³ãƒãƒ³ãƒ‰å†…ã®æ–‡å­—åˆ—|ç½®ãæ›ãˆã‚‹å€¤|
|---|---|
|`$LABEL`|äº‹å‰æº–å‚™ã§ç¢ºèªã—ãŸã€Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¿ã‚¤ãƒˆãƒ«ã€|
|`$URL`|äº‹å‰æº–å‚™ã§ç¢ºèªã—ãŸã€ŒMSI ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã®å…¬é–‹ URLã€|
|`$APPEND_ARGUMENTS`|MSI ã«è¿½åŠ ã§å¼•æ•°ã‚’æ¸¡ã—ãŸã„å ´åˆã¯ã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Šã§å…¥åŠ›ã€‚å¿…è¦ãªã„å ´åˆã¯ `-appendArguments` ã”ã¨å‰Šé™¤ã§OK|

ä¾‹ãˆã°ã€ä¾‹ã«æŒ™ã’ãŸ Google Chrome ã‚„ Zoom ã§ã¯ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚

|ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³|ã‚³ãƒãƒ³ãƒ‰ä¾‹|
|---|---|
|Google Chrome (64bit)|`powershell -ExecutionPolicy Bypass -File ".\msiInstaller.ps1" -label "Google Chrome" -installerUrl "https://dl.google.com/tag/s/appguid%3D%7B8A69D345-D564-463C-AFF1-A69D9E530F96%7D%26iid%3D%7B68387BA0-557D-F80F-58A1-9E5EDDE82361%7D%26browser%3D5%26usagestats%3D0%26appname%3DGoogle%2520Chrome%26needsadmin%3Dtrue%26ap%3Dx64-stable-statsdef_0%26brand%3DGCPK/dl/chrome/install/googlechromestandaloneenterprise64.msi"`|
|Zoom (64bit)|`powershell -ExecutionPolicy Bypass -File ".\msiInstaller.ps1" -label "Zoom Workplace (64-bit)" -installerUrl "https://zoom.us/client/latest/ZoomInstallerFull.msi?archType=x64"`|
|1Password|`powershell -ExecutionPolicy Bypass -File ".\msiInstaller.ps1" -label "1Password" -installerUrl "https://downloads.1password.com/win/1PasswordSetup-latest.msi" -appendArguments "MANAGED_INSTALL=1 /norestart"`|

:::message
ã‚³ãƒãƒ³ãƒ‰ã®æœ«å°¾ã« `-isDebug` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚‹ã¨ `C:Â¥IntuneLog` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«å®Ÿè¡Œãƒ­ã‚°ãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚
:::

#### ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚³ãƒãƒ³ãƒ‰

ä¸‹è¨˜æ–‡å­—åˆ—ã‚’å…¥åŠ›ã—ã¾ã™ã€‚ä¸€éƒ¨æ›¸ãæ›ãˆãªã„ã¨ã„ã‘ãªã„ç®‡æ‰€ãŒã‚ã‚‹ã®ã§ã€ã€Œã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚³ãƒãƒ³ãƒ‰ã€é …ã§æŒ™ã’ãŸå¯¾å¿œè¡¨ã¨åŒã˜ã‚‚ã®ã‚’å…¥ã‚Œã¦ãã ã•ã„ã€‚

```sh
powershell -ExecutionPolicy Bypass -File ".\msiInstaller.ps1" -label "$LABEL" -uninstall
```

ä¾‹ãˆã°ã€ä¾‹ã«æŒ™ã’ãŸ Google Chrome ã‚„ Zoom ã§ã¯ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚

|ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³|ã‚³ãƒãƒ³ãƒ‰ä¾‹|
|---|---|
|Google Chrome (64bit)|`powershell -ExecutionPolicy Bypass -File ".\msiInstaller.ps1" -label "Google Chrome" -uninstall`|
|Zoom (64bit)|`powershell -ExecutionPolicy Bypass -File ".\msiInstaller.ps1" -label "Zoom Workplace (64-bit)" -uninstall`|
|1Password|`powershell -ExecutionPolicy Bypass -File ".\msiInstaller.ps1" -label "1Password" -uninstall`|

:::message
ã‚³ãƒãƒ³ãƒ‰ã®æœ«å°¾ã« `-isDebug` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚‹ã¨ `C:Â¥IntuneLog` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«å®Ÿè¡Œãƒ­ã‚°ãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚
:::

#### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®å‡¦ç†

äº‹å‰æº–å‚™ã§ç¢ºèªã—ãŸã€Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æœ¬ä½“ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã€ã«ã‚ˆã£ã¦å€¤ã‚’å¤‰ãˆã¾ã™ã€‚

- ãƒ‘ã‚¹ãŒ `C:Â¥UsersÂ¥` é…ä¸‹ã§ã‚ã‚‹å ´åˆï¼š`ãƒ¦ãƒ¼ã‚¶ãƒ¼`
- ãƒ‘ã‚¹ãŒä¸Šè¨˜ä»¥å¤–ã®å ´åˆï¼š`ã‚·ã‚¹ãƒ†ãƒ `

### æ¤œå‡ºãƒ«ãƒ¼ãƒ«

å‰è¿°ã®é€šã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã§ Product ID ãŒå¤‰ã‚ã‚‹ã®ã§ MSI ã§ã¯ãªããƒ•ã‚¡ã‚¤ãƒ«ã®æœ‰ç„¡ã§æ¤œå‡ºã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚

### ãã®ä»–ã®è¨­å®š

ç‰¹ã«ç‰¹ç­†ã™ã‚‹ã“ã¨ãŒãªã„ã®ã§å‰²æ„›ã—ã¾ã™ã€‚

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œã«å¤±æ•—ã—ã€`-isDebug` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã¦ã‚‚ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œãªã„ã¨ãã¯æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ããªã„ã“ã¨ãŒå¤šã„ã§ã™ã€‚

## æœ€å¾Œã«

ã¨ã„ã†ã‚ã‘ã§ã€MSI ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ Intune ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãªãã€è‡ªå‹•ã§é…å¸ƒå…ˆã‹ã‚‰å–å¾—ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚

ã“ã“ã¾ã§æ›¸ã„ã¦æ°—ã¥ã„ãŸã‚“ã§ã™ãŒã€PowerShell ã‚’å®Ÿè¡Œã§ãã‚‹ç’°å¢ƒãªã‚‰ Intune ã˜ã‚ƒãªãã¦ã‚‚å‹•ãã¾ã™ã­â€¦ï½—ã€‚

è¨˜è¼‰ã—ãŸå†…å®¹ã«ã¤ã„ã¦ä½•ã‹ã‚ã‚Šã¾ã—ãŸã‚‰è¨˜äº‹ã‚³ãƒ¡ãƒ³ãƒˆã‹ X/Twitter ã¾ã§ã”é€£çµ¡ãã ã•ã„ã€‚
